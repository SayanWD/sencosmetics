# Спецификация и ТЗ (Client)

## 1. Обзор
- Контекст: Sencosmetics — D2C e‑commerce витрина (Next.js + Supabase). Этап 1: Landing Page MVP (home, about/brand, коллекция витринная без покупки, лид‑формы, FAQ). Мультиязычность обязательна: KZ и RU с локализацией контента и метаданных. Далее — развитие до каталога, PDP, корзины и оплаты.
- Вне рамок (MVP): личный кабинет, реальный склад/OMS, сложные промо‑механики, мультивалютность, отзывы с модерацией в проде, полноценный CMS.

### 1.1 Фазы
- Этап 1: Лендинг (контент, SEO, аналитика, сбор лидов, i18n KZ/RU)
- Этап 2: Каталог и PDP
- Этап 3: Корзина и упрощённый checkout

## 2. Требования
### 2.1 Функциональные
- Этап 1 — Лендинг
  - История: Домашняя страница
    - Контентные блоки: hero, преимущества, коллекции (витрина без покупки), отзывы (статик), CTA
    - Acceptance: все тексты локализованы (KZ/RU); изображения оптимизированы; web‑виталы в бюджете
  - История: О бренде / FAQ / Контакты
    - Страницы с SEO‑метаданными; микроразметка Organization/FAQPage; контактная форма
    - Acceptance: валидация форм (Zod), honeypot, отправка/запись заявки
- Этап 2+ — Каталог/PDP/Корзина/Checkout (в последующих релизах)
- История: Просмотр каталога
  - Пользователь видит категории, фильтры (категория, теги), сортировку (популярность, новизна, цена)
  - Acceptance: список загружается < 1s TTFB на теплых кэшах; пустое состояние отображается корректно
- История: Карточка товара (PDP)
  - Пользователь видит фото, состав/описание, цену, наличие, рекомендации, отзывы (статические/заглушка)
  - Acceptance: добавление в корзину доступно; недоступные варианты отображаются; schema.org Product разметка
- История: Корзина
  - Добавление/удаление/изменение количества, подсчет суммы и доставки (фикс. тариф)
  - Acceptance: состояние сохраняется в localStorage + серверная корзина по sessionId (если доступно)
- История: Оформление (упрощенно)
  - Ввод контактных данных, редирект в платёжного провайдера (Hosted Checkout)
  - Acceptance: валидация форм (Zod), обработка ошибок, трекинг begin_checkout/purchase
- История: Подписка на рассылку
  - Поле email с double‑opt‑in через ESP
  - Acceptance: подтверждение, антиспам, сохранение статуса
- История: Форма консультации/обратной связи
  - Поля: имя, email, тема, сообщение; запись в БД и отправка в почту/CRM webhook
  - Acceptance: валидация, антибот (honeypot), страница «спасибо»

### 2.2 Нефункциональные
- Производительность: P75 LCP < 2.5s, CLS < 0.1, INP < 200ms; изображения WebP/AVIF, lazy‑load; CDN кеш; code‑split
- Доступность: axe — 0 serious/critical; клавиатура/фокус; контраст по WCAG AA; aria‑атрибуты
- SEO: уникальные title/description/H1, OG/Twitter, sitemap.xml, robots.txt, каноникал, schema.org на PDP/Organization/Breadcrumb
- Безопасность: валидация ввода (Zod), RLS для Supabase, секреты только через ENV, rate limiting на API
- Приватность: согласие на cookies, отказ от PII‑логирования, masked IDs
- i18n (обязательно): KZ и RU, единая структура ключей, fallback, форматирование дат/валют по локали, RTL‑готовность в компонентах
- Надёжность: 99.9% CDN, graceful degradation без JS, empty/error states

## 3. Интеграции
- Аналитика: GTM/GA4 (page_view, add_to_cart, begin_checkout, purchase)
- Платежи: Stripe или YooKassa (Hosted Checkout, редирект‑флоу)
- ESP: Brevo или Mailchimp (double‑opt‑in)
- Supabase: аутентификация (опционально), хранение каталога/контактов, RLS политики
- Вебхуки: purchase success/cancel (маркировка заказа), ESP subscribe events

## 4. Данные и БД
- Модели (Supabase):
  - product(id, slug, name, price, currency, images[], description, ingredients, tags[], is_active)
  - category(id, slug, name)
  - product_category(product_id, category_id)
  - review(id, product_id, rating, title, body, created_at, is_approved)
  - cart(id, session_id, user_id?)
  - cart_item(id, cart_id, product_id, qty, price_at_moment)
  - order(id, cart_id, status, total_amount, provider, provider_ref, created_at)
  - newsletter_subscriber(id, email, status, subscribed_at)
  - contact_request(id, name, email, subject, message, created_at)
- Политики доступа: чтение каталога — публично (RLS: anon read only), запись заказов/контактов — сервис‑роль/secure API, отзывы — только модерация

## 5. Дизайн и контент
- Figma: макеты страниц (home/catalog/PDP/cart/checkout/brand, 404, states)
- Контент: локализация через ключи (namespace per page), дата‑форматы и валюты
- Компоненты: доступные формы (label, error, helper), видимые состояния загрузки/ошибок

## 6. Критерии приёмки
- Демо‑скрипт: пройти путь home → каталог → PDP → корзина → checkout (редирект) → возврат
- Тест‑кейсы:
  - Каталог: фильтры/сортировки работают; пустое состояние; пагинация/загрузка
  - PDP: добавление в корзину, разметка schema.org валидируется
  - Корзина: изменение qty, пересчет суммы, persist между перезагрузками
  - Checkout: валидация, обработка ошибок, трекинг событий
  - Подписка/контакт: double‑opt‑in, запись в БД, защита от ботов
- Веб‑виталы соответствуют бюджетам на P75 (Chrome UX Report or Lighthouse lab с оговорками)
- i18n acceptance:
  - Переключатель языка доступен с клавиатуры и сохраняет выбранную локаль
  - Локализованы UI‑строки, метаданные страниц (title/description), OG и schema.org
  - Hreflang/каноникал корректны, локаль в URL (`/kz`, `/ru`) с международной маршрутизацией Next.js

## 7. Риски и допущения
- Риски: дефицит контента/медиа, задержка интеграций провайдеров, нестабильность логистики
- Допущения: небольшая номенклатура (<= 300 SKU), один регион доставки, фиксированные тарифы
- Таймлайн: MVP 4–6 недель, затем итерации (Loyalty, отзывы с модерацией, личный кабинет)

## 8. Ссылки
- На PR/Issues/Доки: будет пополняться в процессе
